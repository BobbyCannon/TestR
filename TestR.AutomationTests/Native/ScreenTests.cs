#region References

using System.Drawing.Imaging;
using System.IO;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using TestR.Native;
using TestR.UnitTests;

#endregion

namespace TestR.AutomationTests.Native
{
	[TestClass]
	public class ScreenTests : BaseTest
	{
		#region Methods

		[TestMethod]
		public void ConvertToDataUrlUsingFilePath()
		{
			var expected = "data:image/png;base64,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";
			var actual = Screen.ConvertToDataUrl(SolutionPath + "\\testr.png");
			actual.ToLiteral().Dump();
			Assert.AreEqual(expected, actual);
		}
		
		[TestMethod]
		public void ConvertFromDataUrl()
		{
			var data = "data:image/png;R0lGODlhAQABAIAAAAAAAAAAACH5BAAAAAAALAAAAAABAAEAAAICTAEAOw==";
			var expected = new byte[] { 0x84, 0x04, 0x00, 0x04, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x87, 0xE4, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x04, 0x00, 0x00, 0x08, 0x09, 0x30, 0x04, 0x3B };
			var actual = Screen.ConvertFromDataUrl(data);
			//actual.ToLiteral().Dump();
			TestHelper.AreEqual(expected, actual);
		}
		
		#endregion
	}
}